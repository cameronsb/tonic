/*
 * Piano Key Styles
 *
 * Colors are defined in src/index.css (design system)
 * - Chord highlighting: orange-based (--key-chord-*)
 * - Scale highlighting: opacity-based (dims non-scale keys)
 */

.piano-key {
  position: absolute;
  cursor: pointer;
  user-select: none;
  border-radius: 0 0 4px 4px;
  transition:
    transform 0.05s ease,
    box-shadow 0.05s ease;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  align-items: center;
  padding-bottom: 0.5rem;
  border-color: black;
  /* Touch optimizations - tells browser we're handling touch */
  touch-action: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
}

/* White keys */
.piano-key.white {
  width: var(--white-key-width);
  height: var(--white-key-height);
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.4);
  border-top: none;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 1;
}

.piano-key.white:hover {
  background: #f9f9f9;
}

.piano-key.white.pressed {
  background: #e8e8e8;
  transform: translateY(2px);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Black keys */
.piano-key.black {
  width: var(--black-key-width);
  height: var(--black-key-height);
  background: linear-gradient(180deg, #2a2a2a 0%, #1a1a1a 100%);
  border: 1px solid #000;
  border-top: none;
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
  z-index: 2;
  padding-bottom: 0.35rem;
}

.piano-key.black:hover {
  background: linear-gradient(180deg, #3a3a3a 0%, #2a2a2a 100%);
}

.piano-key.black.pressed {
  background: linear-gradient(180deg, #1a1a1a 0%, #0a0a0a 100%);
  transform: translateY(2px);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* ========================================
 * Scale highlighting — Opacity-based approach
 * Instead of coloring in-scale keys, we dim non-scale keys.
 * This allows chord highlighting (orange) to coexist cleanly.
 * ======================================== */

.piano-key.not-in-scale {
  opacity: 0.35;
  filter: grayscale(0.3);
}

.piano-key.not-in-scale:hover {
  opacity: 0.5;
  filter: grayscale(0.2);
}

/* Chord highlighting */
.piano-key.white.in-chord {
  background: var(--key-chord-white);
}

.piano-key.white.in-chord:hover {
  background: var(--key-chord-white-hover);
}

.piano-key.white.in-chord.pressed {
  background: var(--key-chord-white-pressed);
}

.piano-key.black.in-chord {
  background: var(--key-chord-black);
}

.piano-key.black.in-chord:hover {
  background: var(--key-chord-black-hover);
}

.piano-key.black.in-chord.pressed {
  background: var(--key-chord-black-pressed);
}

/* Key labels */
.key-label {
  display: flex;
  flex-direction: column-reverse;
  align-items: center;
  gap: 0.25rem;
  pointer-events: none;
}

.note-name {
  color: black;
  font-weight: 500;
  font-size: 14px;
}

.scale-degree {
  color: black;
  font-size: 14px;
  font-weight: 600;
}

/* Black key labels — light text for contrast */
.piano-key.black .key-label {
  gap: 0.15rem;
}

.piano-key.black .note-name {
  color: rgba(255, 255, 255, 0.9);
  font-size: 12px;
}

.piano-key.black .scale-degree {
  color: rgba(255, 255, 255, 0.75);
  font-size: 11px;
}

/* Black key in-chord labels — dark text on orange background */
.piano-key.black.in-chord .note-name,
.piano-key.black.in-chord .scale-degree {
  color: rgba(0, 0, 0, 0.85);
}

/* White key in-chord labels */
.piano-key.white.in-chord .note-name,
.piano-key.white.in-chord .scale-degree {
  color: black;
  font-weight: 600;
}

/* Responsive font sizes */
@media (max-width: 768px) {
  .key-label {
    font-size: 10px;
  }

  .note-name {
    font-size: 9px;
  }

  .scale-degree {
    font-size: 8px;
  }

  .piano-key.black .note-name {
    font-size: 9px;
  }

  .piano-key.black .scale-degree {
    font-size: 8px;
  }
}

@media (max-width: 480px) {
  .piano-key {
    padding-bottom: 0.25rem;
  }

  .key-label {
    font-size: 9px;
    gap: 0.15rem;
  }

  .note-name {
    font-size: 8px;
  }

  .scale-degree {
    font-size: 7px;
  }

  .piano-key.black .note-name {
    font-size: 8px;
  }

  .piano-key.black .scale-degree {
    font-size: 7px;
  }
}

/* MIDI active state - subtle glow effect */
.piano-key.midi-active {
  box-shadow: 0 0 8px 2px rgba(34, 197, 94, 0.5);
}

.piano-key.white.midi-active {
  box-shadow: 0 0 8px 2px rgba(34, 197, 94, 0.5);
}

.piano-key.black.midi-active {
  box-shadow: 0 0 8px 2px rgba(34, 197, 94, 0.6);
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
  .piano-key {
    touch-action: manipulation;
  }
}
